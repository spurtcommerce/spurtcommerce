"use strict";(self.webpackChunkspurtcommerce=self.webpackChunkspurtcommerce||[]).push([[3464],{3464:(rt,R,n)=>{n.r(R),n.d(R,{RoleModule:()=>lt});var d=n(60177),O=n(40528),r=n(89417),k=n(74054),h=n(27802),f=n(63597),F=n(49705),m=n(51188);const G={roleName:{label:"Settings.Role.RoleName",name:"roleName",validatiors:[r.k0.required,r.k0.pattern(/^[a-zA-Z\s]*$/)],type:"text",placeholder:"Settings.Role.RoleName",mandatory:!0,optionalErrorMessage:{pattern:"ValidationsErrorMessage.Allowonlyalphabetsspaces"}},isActive:{label:"Settings.Role.Status",name:"isActive",type:"toggle",placeholder:"Settings.Role.Status",mandatory:!1,customData:{toggleName:"roleStatus"}}};var u=n(98852),t=n(54438),S=n(37886),j=n(18186),p=n(41780);function N(s,a){if(1&s&&(t.qex(0),t.j41(1,"div",9)(2,"div",10),t.nrm(3,"app-common-form",11),t.k0s()(),t.bVm()),2&s){const e=a.$implicit,o=t.XpG();t.R7$(3),t.Y8G("type",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].type)("control",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].control)("label",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].label)("inputId",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].inputId)("aliasName",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].aliasName)("placeholder",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].placeholder)("submitted",o.submitted)("customData",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].customData)("optionalErrorMessage",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].optionalErrorMessage)("mandatory",null==o.dynamicObjControls[e]?null:o.dynamicObjControls[e].mandatory)}}let g=(()=>{class s{constructor(e,o,i,l,c,y,v){this.fb=e,this.appSandbox=o,this.route=i,this.router=l,this.ref=c,this.service=y,this.modalService=v,this._Object=Object,this.dynamicObjControls={},this.roleInfo=[],this.submitted=!1,this.pageSize="10",this.keyword="",this.currentPage=1,this.trackByIndex=C=>C,this.limit=sessionStorage.getItem("itemsPerPage")?Number(sessionStorage.getItem("itemsPerPage")):10}ngOnInit(){this.buildForm(),this.intializeFunction()}getRolelist(){this.offset=(this.currentPage-1)*this.limit;const e={};e.limit=this.limit,e.offset=this.offset,e.keyword=this.keyword,this.appSandbox.getRoleList(e)}getRoleListCount(e=0,o){const i={};i.limit=o,i.offset=e,i.keyword=this.keyword,i.count=!0,this.appSandbox.getpagination(i)}cancel(){this.roleInfo=null,this.roleInfo=" ",this.modalService.close("close")}onChangestatus(e){this.isChecked=e.target.checked,1==this.isChecked?this.value=1:0==this.isChecked&&(this.value=0)}onSubmit(){if(this.submitted=!0,!this.formObjFormGroup.invalid&&""!==this.formObjFormGroup.value.name){const e={};e.name=this.formObjFormGroup.value.roleName,e.status=this.formObjFormGroup.value.isActive??0,this.roleInfo&&this.roleInfo[0]&&this.roleInfo[0].groupId?(e.groupId=this.roleInfo[0].groupId,e.status=this.formObjFormGroup.value.isActive??0,this.appSandbox.updateRole(e),this.modalService.close("close")):(this.appSandbox.addRole(e),this.modalService.close("close"))}}close(){this.modalService.close("close")}editRoleList(){this.roleInfo.push(this.service.rolegetdata()),null!==this.roleInfo[0]?(console.log("sdasda",this.roleInfo[0]),this.roleInfo[0]&&this.roleInfo[0].name&&"edit"===this.edit&&setTimeout(()=>{this.formObjFormGroup.controls.roleName.setValue(this.roleInfo[0].name),this.formObjFormGroup.controls.isActive.setValue(this.roleInfo[0].isActive)},100)):(this.formObjFormGroup.patchValue({roleName:null,isActive:null}),this.roleInfo=null)}buildForm(){const e=G,o=(0,u.b0)(e);this.formObjFormGroup=this.fb.group(o),Object.keys(e).forEach(i=>{this.dynamicObjControls[i]=(0,u.yE)(e[i],this.formObjFormGroup)})}intializeFunction(){this.roleName=null,this.isActive=null,this.editRoleId=this.route.snapshot.paramMap.get("id"),this.getRolelist(),this.editRoleList()}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(r.ze),t.rXU(h.k),t.rXU(m.nX),t.rXU(m.Ix),t.rXU(t.gRc),t.rXU(f.H),t.rXU(S.Lw))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-spurt-settings-role-add"]],inputs:{edit:"edit",id:"id"},decls:13,vars:7,consts:[[1,"flex","setting2-inner-header"],[1,"modal-header__title"],[1,"close-modal",3,"click"],["src","assets/img/modal-close.svg"],[1,"modal-body"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"action-button-container","flex"],[1,"button-reg","btn-md","tertiary",3,"click"],[1,"button-reg","btn-md","primary",3,"click"],[1,"ap-body-col"],[1,"form-group"],[3,"type","control","label","inputId","aliasName","placeholder","submitted","customData","optionalErrorMessage","mandatory"]],template:function(o,i){1&o&&(t.j41(0,"div",0)(1,"h3",1),t.EFF(2),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return i.close()}),t.nrm(4,"img",3),t.k0s()(),t.j41(5,"div",4),t.DNE(6,N,4,10,"ng-container",5),t.k0s(),t.j41(7,"div",6)(8,"button",7),t.bIt("click",function(){return i.close()}),t.EFF(9),t.nI1(10,"translate"),t.k0s(),t.j41(11,"button",8),t.bIt("click",function(){return i.onSubmit()}),t.EFF(12),t.k0s()()),2&o&&(t.R7$(2),t.SpI(" ",i.roleInfo?"Update Role":" Add Role"," "),t.R7$(4),t.Y8G("ngForOf",i._Object.keys(i.dynamicObjControls))("ngForTrackBy",i.trackByIndex),t.R7$(3),t.SpI(" ",t.bMT(10,5,"Settings.User.Cancle")," "),t.R7$(3),t.SpI(" ",i.roleInfo?"Update Role":"Save"," "))},dependencies:[d.Sq,j.V,p.D9],encapsulation:2})}}return s})();var L=n(18359),T=n(55735),A=n(64363);function I(s){for(const a in s)s.hasOwnProperty(a)&&(null==s[a]||""===s[a])&&delete s[a];return s}const P={Search:{label:"marketplace.common.Search",name:"search",aliasName:"",validators:[],type:"text",placeholder:"marketplace.common.Search"}},D={1:{text:"common.Active",class:"active"},0:{text:"common.In-Active",class:"inactive"}};var M=n(345),V=n(27952),$=n(34501),U=n(42612),X=n(87277),w=n(35697);const x=["myDropdown"],B=["myInput"],Y=s=>({productStatus:s}),z=s=>[s];function Q(s,a){if(1&s){const e=t.RV6();t.j41(0,"div",23)(1,"span"),t.EFF(2),t.k0s(),t.j41(3,"button",24),t.bIt("click",function(){t.eBV(e);const i=t.XpG().$implicit,l=t.XpG();return t.Njj(l.removeFilter(i))}),t.nrm(4,"img",25),t.k0s()()}if(2&s){const e=t.XpG().$implicit;t.R7$(2),t.Lme("",e.key," :",e.value," ")}}function H(s,a){if(1&s&&(t.j41(0,"div",21),t.DNE(1,Q,5,2,"div",22),t.k0s()),2&s){const e=a.$implicit,o=t.XpG();t.R7$(),t.Y8G("ngIf",!o.empty.includes(e.value))}}function _(s,a){1&s&&t.nrm(0,"app-list-skeleton")}function J(s,a){if(1&s){const e=t.RV6();t.j41(0,"app-common-table",26),t.bIt("buttonChangeEvent",function(i){t.eBV(e);const l=t.XpG();return t.Njj(l.buttonAction(i))}),t.k0s()}if(2&s){const e=t.XpG(),o=t.sdS(31);t.Y8G("HeadArray",e.dynamicColumnFields)("GridArray",e.roleList)("customTemplate",t.eq3(3,Y,o))}}function Z(s,a){if(1&s&&t.nrm(0,"app-common-badge",27),2&s){const e=a.$implicit,o=t.XpG();t.Y8G("badge",o.badgeStatusMappings.hasOwnProperty(e.isActive)?o.badgeStatusMappings[e.isActive]:"")}}function K(s,a){1&s&&(t.j41(0,"div",28)(1,"span"),t.nrm(2,"img",29),t.k0s(),t.j41(3,"h5"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()),2&s&&(t.R7$(4),t.JRh(t.bMT(5,1,"Dashboard.NoDatafound")))}function W(s,a){if(1&s){const e=t.RV6();t.j41(0,"div",30)(1,"app-reusable-pagination",31),t.bIt("pageChange",function(i){t.eBV(e);const l=t.XpG();return t.Njj(l.onPageChange(i))}),t.k0s()()}if(2&s){const e=t.XpG();t.R7$(),t.Y8G("type","numbers")("currentPage",e.currentPage)("totalItems",e.roleCount)("pageSize",t.eq3(4,z,e.limit))}}let q=(()=>{class s{constructor(e,o,i,l,c,y,v,C){this.router=e,this.route=o,this.fb=i,this.ref=l,this.appSandbox=c,this.service=y,this.modalService=v,this.titleService=C,this._Object=Object,this.empty=[null,"",void 0],this.dynamicColumnFields=structuredClone((()=>{const s=(0,A.ZQ)();return[{displayName:"Settings.Role.Name",id:"name",type:"default",checked:!0,filterColName:"uniformListColumName.orderId"},{displayName:"Settings.Role.Status",id:"productStatus",type:"template",checked:!0,filterColName:"uniformListColumName.status",customStyle:{trow:{class:"text-center"},tbody:{class:"text-center"}}},{displayName:"Settings.Local.Country.Action",type:"threeDotMenu",checked:!0,isDisable:!s["edit-role"]&&!s["delete-role"]&&!s["edit-role-permission"],customStyle:{trow:{class:"text-center"},tbody:{class:"text-center"}},menuData:[{name:"Edit",img:"assets/img/edit.svg",displayName:"marketplace.common.Edit",isDisable:!s["edit-role"]},{name:"Delete",img:"assets/img/delete-new.svg",displayName:"marketplace.common.Delete",isDisable:!s["delete-role"]},{name:"role",img:"assets/img/elliptical-h.svg",displayName:"Settings.nav.Permission",isDisable:!s["edit-role-permission"]}]}]})()),this.subscriptions=new L.yU,this.badgeStatusMappings=D,this.roledetails={},this.pageSize="10",this.keyword="",this.currentPage=1,this.filterSearch={},this.type="edit",this.roleList=[],this.dynamicObjControls={},this.backupFormValue={},this.formValueExists=!1,this.limit=sessionStorage.getItem("itemsPerPage")?Number(sessionStorage.getItem("itemsPerPage")):10,this.spinner=!1,this.trackByIndex=at=>at,this.titleService.setTitle("Settings | Access and permission"),this.regSubscribeEvents()}ngOnInit(){this.buildForm(),this.routeSubscribe()}buttonAction(e){"threeDotMenu"===e.key&&("Delete"==e.actionType?this.deleteRole(e?.groupId):"Edit"==e.actionType?this.addNewRole(e,"Edit"):"role"==e.actionType&&this.goToPermission(e))}addNewRole(e,o){this.roledetails=null,this.service.rolesetdata(this.roledetails);const i=this.modalService.open(g,{windowClass:"add-local",backdrop:"static",centered:!1,animation:!1});"Edit"===o&&(this.roledetails=e,this.service.rolesetdata(this.roledetails),i.componentInstance.edit=this.type,i.componentInstance.id=e),i.result.then(l=>{})}getRolelist(){this.updateSpinner("spinner",!0),this.offset=(this.currentPage-1)*this.limit;let e=I(this.getQueryParam());e.count=!1,this.subscriptions.add(this.service.roleList(e).subscribe(o=>{this.updateSpinner("spinner"),this.roleList=o?.data,this.ref.markForCheck()},o=>{this.updateSpinner("spinner")})),this.updateQueryParam()}updateSpinner(e,o=!1){this.hasOwnProperty(e)&&(this.spinner=o)}onPageChange(e){this.limit=e.limit,this.currentPage=Math.floor(e.offset/e.limit)+1,this.getRolelist()}goToPermission(e){JSON.parse(sessionStorage.getItem("adminUserdetail")),this.router.navigate(["/settings/access-and-permission/permission"],{queryParams:{user:JSON.stringify({id:e.groupId,type:"role",role:e.name}),name:"role"}})}deleteRole(e){const o=this.modalService.open(T.i,{size:"sm",windowClass:"delete-confirm",backdrop:"static",modalDialogClass:"modal-dialog-centered",backdropClass:"createcr"});o.componentInstance.key="",o.componentInstance.id="",o.componentInstance.deleteMessage="Role",o.result.then(i=>{if("deleted"===i){const l={};l.groupId=e,this.appSandbox.deleteRole(l),this.appSandbox.roleDelete$.subscribe(c=>{c&&1===c.status&&(this.getRolelist(),this.getRoleListCount())})}})}searchList(){this.keyword?(this.filterSearch.keyword=this.keyword,this.getRolelist(),this.getRoleListCount()):(this.getRolelist(),this.getRoleListCount())}keywordchange(e){this.filterSearch.keyword=e}getRoleListCount(){this.offset=(this.currentPage-1)*this.limit;let e=I(this.getQueryParam());e.count=!0,this.subscriptions.add(this.service.roleList(e).subscribe(o=>{this.roleCount=o?.data,this.ref.markForCheck()}))}dropDownClose(e){this.hasOwnProperty(e)&&this[e]?.close()}resetAll(){this.onPageChange({limit:this.limit,offset:0}),this.getRoleListCount(),this.dropDownClose("myDropdown")}applyFilter(){this.filterValueUpdate(),this.resetAll()}removeFilter(e){this.formObjFormGroup.controls[e.key].reset(),this.filterValueUpdate(),this.resetAll()}buildForm(){const e=P,o=(0,u.b0)(e);this.formObjFormGroup=this.fb.group(o),Object.keys(e).forEach(i=>{this.dynamicObjControls[i]=(0,u.yE)(e[i],this.formObjFormGroup)}),this.filterValueUpdate()}filterValueUpdate(){this.backupFormValue=structuredClone(this.formObjFormGroup?.value),this.formValueExists=Object.values(this.backupFormValue).some(e=>!this.empty.includes(e))}regSubscribeEvents(){this.subscriptions.add(this.appSandbox.roleDelete$.subscribe(e=>{e&&1===e.status&&this.getRolelist()}))}updateQueryParam(){this.router.navigate([],{queryParams:this.getQueryParam(),queryParamsHandling:"merge"})}getQueryParam(){return{limit:this.limit,offset:this.offset,keyword:this.backupFormValue.search??""}}routeSubscribe(){let e={};this.subscriptions.add(this.route.queryParams.subscribe(o=>{e=o,this.limit=e.limit?Number(e.limit):this.limit,this.offset=e.offset?Number(e.offset):0,this.currentPage=e.offset&&e.limit?Math.floor(e.offset/e.limit)+1:1,this.formObjFormGroup.patchValue({search:e.keyword??""}),this.filterValueUpdate()})),this.getRolelist(),this.getRoleListCount(),this.appSandbox.roleUpdateLoaded$.subscribe(o=>{!0===o&&(this.getRolelist(),this.getRoleListCount())}),this.appSandbox.roleAddLoaded$.subscribe(o=>{!0===o&&(this.getRolelist(),this.getRoleListCount())})}ngOnDestroy(){this.subscriptions.unsubscribe()}static{this.\u0275fac=function(o){return new(o||s)(t.rXU(m.Ix),t.rXU(m.nX),t.rXU(r.ze),t.rXU(t.gRc),t.rXU(h.k),t.rXU(f.H),t.rXU(S.Bq),t.rXU(M.hE))}}static{this.\u0275cmp=t.VBU({type:s,selectors:[["app-settings-role-list"]],viewQuery:function(o,i){if(1&o&&(t.GBs(x,5),t.GBs(B,5)),2&o){let l;t.mGM(l=t.lsd())&&(i.myDropdown=l.first),t.mGM(l=t.lsd())&&(i.myInput=l.first)}},decls:34,vars:28,consts:[["itemTemplateRef",""],[1,"local-content"],[1,"set-lay-notes","flex"],[1,"flex","filter-row"],[1,"filter-lft"],[1,"filter-rht","flex"],["class","added-filter flex",4,"ngFor","ngForOf","ngForTrackBy"],[1,"filter-search"],[1,"",3,"keyup.enter"],[1,"input-group"],[1,"ig-row"],[3,"type","control","label","inputId","aliasName","placeholder"],["appShowHide","",1,"button-reg","primary","btn-sm",3,"click","hideUnAuthorized"],[1,"flex","product-wrap","example-full-width"],[1,"product-table"],[1,"setup-right"],[4,"ngIf"],[1,""],[3,"HeadArray","GridArray","customTemplate","buttonChangeEvent",4,"ngIf"],["class","nodata-found",4,"ngIf"],["class","pagination flex",4,"ngIf"],[1,"added-filter","flex"],["class","added-filter-col flex filter-detail",4,"ngIf"],[1,"added-filter-col","flex","filter-detail"],[3,"click"],["src","assets/img/close.svg","alt",""],[3,"buttonChangeEvent","HeadArray","GridArray","customTemplate"],[3,"badge"],[1,"nodata-found"],["src","assets/imgs/nodatafound.svg","alt",""],[1,"pagination","flex"],[3,"pageChange","type","currentPage","totalItems","pageSize"]],template:function(o,i){if(1&o){const l=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"h4"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.nI1(7,"translate"),t.k0s()(),t.j41(8,"div",3)(9,"div",4)(10,"h2"),t.EFF(11),t.nI1(12,"translate"),t.k0s()(),t.j41(13,"div",5),t.DNE(14,H,2,1,"div",6),t.nI1(15,"keyvalue"),t.j41(16,"div",7)(17,"form",8),t.bIt("keyup.enter",function(){return t.eBV(l),t.Njj(i.applyFilter())}),t.j41(18,"div",9)(19,"div",10),t.nrm(20,"app-common-form",11),t.k0s()()()(),t.j41(21,"button",12),t.bIt("click",function(){return t.eBV(l),t.Njj(i.addNewRole("","add"))}),t.EFF(22),t.nI1(23,"translate"),t.k0s()()(),t.j41(24,"div",13)(25,"div",14)(26,"div",15),t.DNE(27,_,1,0,"app-list-skeleton",16),t.j41(28,"div",17),t.DNE(29,J,1,5,"app-common-table",18)(30,Z,1,1,"ng-template",null,0,t.C5r)(32,K,6,3,"div",19)(33,W,2,6,"div",20),t.k0s()()()()()}2&o&&(t.R7$(3),t.JRh(t.bMT(4,18,"Settings.nav.Note:")),t.R7$(3),t.JRh(t.bMT(7,20,"Settings.Role.roleBasedContent")),t.R7$(5),t.Lme("",t.bMT(12,22,"Settings.Role.totalRoles")," ( ",i.roleCount," )"),t.R7$(3),t.Y8G("ngForOf",t.bMT(15,24,i.backupFormValue))("ngForTrackBy",i.trackByIndex),t.R7$(6),t.Y8G("type",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.type)("control",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.control)("label",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.label)("inputId",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.inputId)("aliasName",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.aliasName)("placeholder",null==i.dynamicObjControls||null==i.dynamicObjControls.Search?null:i.dynamicObjControls.Search.placeholder),t.R7$(),t.Y8G("hideUnAuthorized","create-role"),t.R7$(),t.SpI(" + ",t.bMT(23,26,"Settings.Role.AddNewRole")," "),t.R7$(5),t.Y8G("ngIf",i.spinner),t.R7$(2),t.Y8G("ngIf",(null==i.roleList?null:i.roleList.length)>0&&!i.spinner),t.R7$(3),t.Y8G("ngIf",0===(null==i.roleList?null:i.roleList.length)&&!i.spinner),t.R7$(),t.Y8G("ngIf",i.roleCount>i.limit))},dependencies:[d.Sq,d.bT,r.qT,r.cb,r.cV,V.s,$.$,U.V,j.V,X.C,w.D,d.lG,p.D9],styles:[".settings-right-wrapper[_ngcontent-%COMP%]{margin-top:0!important}.setting1-inner-header[_ngcontent-%COMP%]{margin-top:40px!important}.coc[_ngcontent-%COMP%]{background:#f20a6d;border:solid thin #dddddd;color:#fff;padding:4px 16px}"]})}}return s})();var b=n(79176);const tt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:q,canActivate:[b.q],data:{permission:"list-role"}},{path:"add",component:g,canActivate:[b.q],data:{permission:"create-role"}},{path:"edit/:id",component:g,canActivate:[b.q],data:{permission:"edit-role"}}];let et=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({imports:[m.iI.forChild(tt),m.iI]})}}return s})();var ot=n(55153),it=n(99014),st=n(21626),nt=n(88650);let lt=(()=>{class s{static{this.\u0275fac=function(o){return new(o||s)}}static{this.\u0275mod=t.$C({type:s})}static{this.\u0275inj=t.G2t({providers:[f.H,h.k],imports:[d.MD,O.D,r.YN,r.X1,ot.G,nt.h,et,k.Vm.forFeature([F.F]),p.h.forChild({loader:{provide:p.Wr,useFactory:it.M,deps:[st.Qq]}})]})}}return s})()}}]);