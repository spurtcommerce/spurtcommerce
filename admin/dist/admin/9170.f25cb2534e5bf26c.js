"use strict";(self.webpackChunkspurtcommerce=self.webpackChunkspurtcommerce||[]).push([[9170],{59170:(It,$,l)=>{l.r($),l.d($,{AuditLogModule:()=>Tt});var b=l(60177),D=l(51188),h=l(89417),I=l(55735);const A=[{displayName:"Settings.nav.User",id:"userName",type:"default",checked:!0,filterColName:"Settings.nav.User"},{displayName:"Settings.data.Module",id:"module",type:"default",checked:!0,filterColName:"Settings.data.Module"},{displayName:"Settings.data.Description",id:"description",type:"default",checked:!0,filterColName:"Settings.data.Description"},{displayName:"Settings.data.Date",id:"createdDate",type:"date",checked:!0,filterColName:"Settings.data.Date",customStyle:{tbody:{class:"text-nowrap"}}},{displayName:"Settings.data.Browser",id:"browser",type:"template",checked:!0,filterColName:"Settings.data.Date"}],x={1:{text:"common.Active",class:"active"},0:{text:"common.In-Active",class:"inactive"}};var t=l(54438),r=l(96940),d=l(34514),u=l(41906);const c=i=>i.auditLog,E=(0,d.Mz)(c,u.qZ),z=(0,d.Mz)(c,u.xL),R=(0,d.Mz)(c,u.uV),j=(0,d.Mz)(c,u.Pk),w=(0,d.Mz)(c,u.Vq),G=(0,d.Mz)(c,u.kz),N=(0,d.Mz)(c,u.X_),B=(0,d.Mz)(c,u._e),U=(0,d.Mz)(c,u.rD),V=(0,d.Mz)(c,u.ai),O=(0,d.Mz)(c,u.Jt),P=(0,d.Mz)(c,u.sx),X=(0,d.Mz)(c,u.MA),H=(0,d.Mz)(c,u.Tm),Y=(0,d.Mz)(c,u.sk),J=(0,d.Mz)(c,u.RV),Q=(0,d.Mz)(c,u.aU),K=(0,d.Mz)(c,u.aK),W=(0,d.Mz)(c,u.dO),_=(0,d.Mz)(c,u.FM),Z=(0,d.Mz)(c,u.tC),q=(0,d.Mz)(c,u.Tw),tt=(0,d.Mz)(c,u.gv),et=(0,d.Mz)(c,u.WK);var it=l(84745);let M=(()=>{class i{constructor(e,s){this.appState=e,this.router=s,this.auditLogModule$=this.appState.select(X),this.auditLogModuleLoading$=this.appState.select(Y),this.auditLogModuleLoaded$=this.appState.select(H),this.auditLogModuleFailed$=this.appState.select(J),this.auditLogDelete$=this.appState.select(w),this.auditLogDeleteLoading$=this.appState.select(N),this.auditLogDeleteLoaded$=this.appState.select(G),this.auditLogDeleteFailed$=this.appState.select(B),this.auditLogList$=this.appState.select(E),this.auditLogListLoading$=this.appState.select(R),this.auditLogListLoaded$=this.appState.select(z),this.auditLogListFailed$=this.appState.select(j),this.getUsersList$=this.appState.select(Q),this.userListLoading$=this.appState.select(K),this.userListLoaded$=this.appState.select(W),this.userListFailed$=this.appState.select(_),this.auditLogListCount$=this.appState.select(U),this.auditLogListCountLoading$=this.appState.select(O),this.auditLogListCountLoaded$=this.appState.select(V),this.auditLogListCountFailed$=this.appState.select(P),this.deleteLogs$=this.appState.select(Z),this.deleteLogsLoading$=this.appState.select(q),this.deleteLogsLoaded$=this.appState.select(tt),this.deleteLogsFailed$=this.appState.select(et)}auditLogList(e){this.appState.dispatch(new r.Ms(e))}auditLogListCount(e){this.appState.dispatch(new r.Jo(e))}getUserList(e){this.appState.dispatch(new r.Js(e))}auditLogDelete(e){this.appState.dispatch(new r.XT(e))}auditLogModule(e){this.appState.dispatch(new r.w7(e))}deleteLogs(e){this.appState.dispatch(new r.r$(e))}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(it.il),t.KVO(D.Ix))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac})}}return i})();var C=l(37886),st=l(345),at=l(27952),ot=l(34501),nt=l(42612),F=l(41780);const lt=i=>({browser:i}),rt=()=>({standalone:!0});function dt(i,g){1&i&&(t.j41(0,"div",25),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&i&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"Settings.nav.PleaseChooseAtleastonedate")," "))}function ut(i,g){1&i&&t.nrm(0,"app-list-skeleton")}function ct(i,g){if(1&i){const e=t.RV6();t.j41(0,"app-common-table",26),t.nI1(1,"async"),t.bIt("buttonChangeEvent",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.buttonAction(o))}),t.k0s()}if(2&i){const e=t.XpG(),s=t.sdS(40);t.Y8G("HeadArray",e.dynamicColumnFields)("GridArray",t.bMT(1,3,e.sandbox.auditLogList$))("customTemplate",t.eq3(5,lt,s))}}function ht(i,g){1&i&&t.EFF(0),2&i&&t.SpI(" ",g.$implicit.browserInfo.browser," ")}function pt(i,g){1&i&&(t.j41(0,"div",27)(1,"p"),t.EFF(2),t.nI1(3,"translate"),t.k0s()()),2&i&&(t.R7$(2),t.JRh(t.bMT(3,1,"Settings.data.DataNotFound")))}function gt(i,g){if(1&i&&(t.j41(0,"option",36),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.FS9("value",e.pageSize),t.R7$(),t.JRh(e.pageSize)}}function mt(i,g){if(1&i){const e=t.RV6();t.j41(0,"div",28)(1,"div",29)(2,"p"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"div",30)(6,"select",31),t.mxI("ngModelChange",function(o){t.eBV(e);const a=t.XpG();return t.DH7(a.pageSize,o)||(a.pageSize=o),t.Njj(o)}),t.bIt("change",function(){t.eBV(e);const o=t.XpG();return t.Njj(o.pageLength())}),t.DNE(7,gt,2,2,"option",32),t.j41(8,"option",33),t.EFF(9,"10"),t.k0s(),t.j41(10,"option",34),t.EFF(11,"20"),t.k0s(),t.j41(12,"option",35),t.EFF(13,"30"),t.k0s()()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.JRh(t.bMT(4,4,"Settings.Local.Resultsperpage")),t.R7$(3),t.R50("ngModel",e.pageSize),t.Y8G("ngModelOptions",t.lJ4(6,rt)),t.R7$(),t.Y8G("ngIf","10"!==e.pageSize&&"20"!==e.pageSize&&"30"!==e.pageSize)}}function Lt(i,g){if(1&i){const e=t.RV6();t.j41(0,"div",37)(1,"app-reusable-pagination",38),t.nI1(2,"async"),t.bIt("pageChange",function(o){t.eBV(e);const a=t.XpG();return t.Njj(a.onPageChange(o))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("type","numbers")("currentPage",e.currentPage)("totalItems",t.bMT(2,4,e.sandbox.auditLogListCount$))("pageSize",e.pageSize)}}const vt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class i{constructor(e,s,o,a,n,L,S){this.sandbox=e,this.router=s,this.route=o,this.fb=a,this.datepipe=n,this.modalService=L,this.titleService=S,this.dynamicColumnFields=structuredClone(A),this.badgeStatusMappings=x,this.filterEnable=!0,this.buttoncheck=!1,this.buttonActive=!1,this.sellerArray=[],this.filterData=[],this.filterDataId=[],this.bulkFunction=!1,this.pageSize=20,this.index=0,this.offset=0,this.keyword="",this.queryData={},this.isRequired=!1,this.subscriptions=[],this.submitted=!1,this.currentPage=1,this.limit=10,this.titleService.setTitle("Settings | System"),this.subscribeVal()}ngOnInit(){this.initForm(),this.intiateFunctions()}pageLength(){this.auditLogList(),this.auditLogListCount()}initForm(){this.fromDate=new h.hs("",[h.k0.required]),this.toDate=new h.hs("",[h.k0.required]),this.auditLogForm=this.fb.group({fromDate:this.fromDate,toDate:this.toDate})}getUserList(){let e=function k(i){for(const g in i)i.hasOwnProperty(g)&&(null==i[g]||""===i[g])&&delete i[g];return i}(this.getQueryParam());e.count=!1,this.sandbox.getUserList(e)}resetFilter(){(""!==this.selectedDays&&null!=this.selectedDays||""!==this.keyword&&null!=this.keyword||""!==this.module&&null!=this.module||""!==this.actionBy&&null!=this.actionBy)&&(this.selectedDays=null,this.keyword="",this.module=null,this.actionBy=null,this.auditLogList(),this.auditLogListCount())}applyFilter(){this.keyword=this.selectedDays,this.module=this.module,this.actionBy=this.actionBy,(""!==this.keyword&&null!=this.keyword||""!==this.module&&null!=this.module||""!==this.actionBy&&null!=this.actionBy)&&(this.auditLogList(),this.auditLogListCount())}checkIfAllSelected(){this.bulkFunction=!0,this.selectedAll=this.sellerArray.every(function(e){return!0===e.selected}),this.filterDataList(),this.bulkFunction=this.filterData.length>0}selectAll(e){for(let s=0;s<this.sellerArray.length;s++)this.sellerArray[s].selected=this.selectedAll;this.filterDataList(),this.bulkFunction=this.filterData.length>0}filterDataList(){this.filterData=this.sellerArray.filter(e=>{if(!0===e.selected)return e}),this.filterDataId=this.filterData.map(e=>e.auditLogId)}check(e){e.target.checked?(this.buttonActive=!1,this.buttoncheck=e.target.checked,this.filterEnable=!0):(this.buttonActive=!0,this.buttoncheck=e.target.checked,this.filterEnable=!1)}auditLogList(){this.offset=(this.currentPage-1)*this.limit;const e={};e.offset=this.offset||0,e.limit=this.pageSize,e.keyword=this.keyword,e.module=this.module?e.module=this.module:"",e.actionBy=this.actionBy?e.actionBy=this.actionBy:"",this.sandbox.auditLogList(e),this.queryData.offset=this.offset||0,this.queryData.index=this.index||0,this.router.navigate([],{relativeTo:this.route,queryParams:this.queryData,queryParamsHandling:"merge"})}auditLogListCount(){const e={offset:0,limit:0};e.keyword=this.keyword,e.module=this.module||"",e.actionBy=this.actionBy||"",e.count=!0,this.sandbox.auditLogListCount(e)}onPageChange(e){this.limit=e.limit,this.currentPage=Math.floor(e.offset/e.limit)+1,this.auditLogList()}deleteDate(){const e=this.auditLogForm.value.fromDate,s=this.auditLogForm.value.toDate;if(e&&e.year&&(this.startDate=e.year+"-"+e.month+"-"+e.day),s&&s.year&&(this.endDate=s.year+"-"+s.month+"-"+s.day),this.auditLogForm.value.fromDate||this.auditLogForm.value.toDate){this.submitted=!1;const o=this.modalService.open(I.i,{size:"sm",windowClass:"delete-confirm",backdrop:"static",modalDialogClass:"modal-dialog-centered",backdropClass:"createcr"});o.componentInstance.key="",o.componentInstance.id="",o.componentInstance.deleteMessage="Audit Log",o.result.then(a=>{if("deleted"===a){const n={};n.fromDate=this.startDate,n.toDate=this.endDate,this.sandbox.deleteLogs(n),this.subscriptions.push(this.sandbox.deleteLogs$.subscribe(L=>{L&&1===L.status&&(this.auditLogList(),this.auditLogListCount(),this.auditLogForm.reset())}))}})}else this.submitted=!0}subscribeVal(){this.subscriptions.push(this.sandbox.auditLogList$.subscribe(e=>{e&&e[0]&&(this.sellerArray=[],this.sellerArray=e.map(s=>({...s,selected:!1})))}))}getQueryParam(){return{limit:this.limit,offset:this.offset,status:"",keyword:""}}intiateFunctions(){this.auditLogList(),this.sandbox.auditLogModule({}),this.auditLogListCount(),this.getUserList(),this.todayDate=new Date,this.maxDate={year:(new Date).getFullYear(),month:(new Date).getMonth(),day:(new Date).getDay()}}ngOnDestroy(){this.subscriptions.forEach(e=>e.unsubscribe())}static{this.\u0275fac=function(s){return new(s||i)(t.rXU(M),t.rXU(D.Ix),t.rXU(D.nX),t.rXU(h.ze),t.rXU(b.vh),t.rXU(C.Bq),t.rXU(st.hE))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-audit-log"]],decls:50,vars:40,consts:[["d","ngbDatepicker"],["e","ngbDatepicker"],["itemTemplateRef",""],[1,"local-content"],[1,"set-lay-notes","flex"],[1,"setup-wrapper","set-loc-wrapper"],[1,"setup-container","localization-container"],[1,"card","ap-general","ap-info"],[3,"formGroup"],[1,"flex","ap-body","mb-3"],[1,"form-group"],["readonly","","type","text","formControlName","fromDate","name","dp","id","cal-in","ngbDatepicker","",1,"form-control","date1",2,"cursor","pointer",3,"click","maxDate"],["style","color: red;",4,"ngIf"],["readonly","","type","text","formControlName","toDate","name","dp","id","cal-in","ngbDatepicker","","ngbDatepicker","",1,"form-control","date1",2,"cursor","pointer",3,"click","minDate"],[1,"button-reg","btn-sm","primary",2,"margin-top","30px","margin-left","0px",3,"click"],[1,"settings-right-wrapper"],[1,"setup-right"],[4,"ngIf"],[1,"product-table"],[1,"table-responsive"],[3,"HeadArray","GridArray","customTemplate","buttonChangeEvent",4,"ngIf"],["class","no_data",4,"ngIf"],[1,"localize-header","flex","bg-transparent"],["class","loc-hdr-lft d-inline-flex",4,"ngIf"],["class","d-inline-flex",4,"ngIf"],[2,"color","red"],[3,"buttonChangeEvent","HeadArray","GridArray","customTemplate"],[1,"no_data"],[1,"loc-hdr-lft","d-inline-flex"],[1,"input-group"],[1,"select"],[3,"ngModelChange","change","ngModel","ngModelOptions"],[3,"value",4,"ngIf"],["value","10"],["value","20"],["value","30"],[3,"value"],[1,"d-inline-flex"],[3,"pageChange","type","currentPage","totalItems","pageSize"]],template:function(s,o){if(1&s){const a=t.RV6();t.j41(0,"div",3)(1,"div",4)(2,"h4"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.nI1(7,"translate"),t.k0s()(),t.j41(8,"div",5)(9,"div",6)(10,"div",7)(11,"form",8)(12,"div",9)(13,"div",10)(14,"label"),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"input",11,0),t.bIt("click",function(){t.eBV(a);const L=t.sdS(18);return t.Njj(L.toggle())}),t.k0s(),t.DNE(19,dt,3,3,"div",12),t.k0s(),t.j41(20,"div",10)(21,"label"),t.EFF(22),t.nI1(23,"translate"),t.k0s(),t.j41(24,"input",13,1),t.bIt("click",function(){t.eBV(a);const L=t.sdS(25);return t.Njj(L.toggle())}),t.k0s()(),t.j41(26,"div",10)(27,"button",14),t.bIt("click",function(){return t.eBV(a),t.Njj(o.deleteDate())}),t.EFF(28),t.nI1(29,"translate"),t.k0s()()(),t.nrm(30,"div",15),t.j41(31,"div",16),t.DNE(32,ut,1,0,"app-list-skeleton",17),t.nI1(33,"async"),t.j41(34,"div",18)(35,"div",19),t.DNE(36,ct,2,7,"app-common-table",20),t.nI1(37,"async"),t.nI1(38,"async"),t.DNE(39,ht,1,1,"ng-template",null,2,t.C5r)(41,pt,4,3,"div",21),t.nI1(42,"async"),t.j41(43,"div",22),t.DNE(44,mt,14,7,"div",23),t.nI1(45,"async"),t.nI1(46,"async"),t.DNE(47,Lt,3,6,"div",24),t.nI1(48,"async"),t.nI1(49,"async"),t.k0s()()()()()()()()()}if(2&s){let a,n,L,S;t.R7$(3),t.JRh(t.bMT(4,14,"Settings.nav.Note:")),t.R7$(3),t.SpI("",t.bMT(7,16,"Settings.nav.SettingAdmin")," "),t.R7$(5),t.Y8G("formGroup",o.auditLogForm),t.R7$(4),t.JRh(t.bMT(16,18,"Settings.nav.LogFrom")),t.R7$(2),t.Y8G("maxDate",o.todayDate),t.R7$(2),t.Y8G("ngIf",!(o.auditLogForm.value.fromDate||o.auditLogForm.value.toDate)&&!0===o.submitted),t.R7$(3),t.JRh(t.bMT(23,20,"Settings.nav.LogTo")),t.R7$(2),t.Y8G("minDate",o.auditLogForm.value.fromDate),t.R7$(4),t.SpI(" ",t.bMT(29,22,"Settings.Local.Delete")," "),t.R7$(4),t.Y8G("ngIf",t.bMT(33,24,o.sandbox.auditLogListLoading$)),t.R7$(4),t.Y8G("ngIf",(null==(a=t.bMT(37,26,o.sandbox.auditLogList$))?null:a.length)>0&&!t.bMT(38,28,o.sandbox.auditLogListLoading$)),t.R7$(5),t.Y8G("ngIf",0==(null==(n=t.bMT(42,30,o.sandbox.auditLogList$))?null:n.length)),t.R7$(3),t.Y8G("ngIf",(null==(L=t.bMT(45,32,o.sandbox.getUsersList$))?null:L.length)>0&&t.bMT(46,34,o.sandbox.auditLogListLoaded$)),t.R7$(3),t.Y8G("ngIf",(null==(S=t.bMT(48,36,o.sandbox.getUsersList$))?null:S.length)>0&&t.bMT(49,38,o.sandbox.auditLogListLoaded$))}},dependencies:[b.bT,h.qT,h.xH,h.y7,h.me,h.wz,h.BC,h.cb,h.vS,h.j4,h.JD,at.s,ot.$,nt.V,C.cw,b.Jj,F.D9],styles:[".button[_ngcontent-%COMP%]{margin-left:10px;border:1px thin white;background:#55af22;color:#fff;width:100px}.input-group[_ngcontent-%COMP%]{font-family:Roboto,Helvetica Neue,sans-serif!important;font-size:12px!important;color:#0000008a!important}.ap-body[_ngcontent-%COMP%]{gap:20px}.form-group[_ngcontent-%COMP%]{margin:0}"]})}}return i})(),canActivate:[l(79176).q],data:{permission:"audit-log",urls:[{title:"breadcrumbs.Reports",url:""},{title:"breadcrumbs.Audit Logs",url:""},{title:"breadcrumbs.List",url:""}]}}];let bt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[D.iI.forChild(vt),D.iI]})}}return i})();var Dt=l(21626),St=l(99014),Mt=l(55153),Ct=l(88650),p=l(74054),y=l(7673),f=l(96354),m=l(25558),v=l(99437),Ft=l(94194);let T=(()=>{class i extends Ft.j{constructor(){super(...arguments),this.params={},this.url=this.getBaseUrl()}auditLogList(e){let s={};return s=e,this.http.get(this.url+"/auditlog/auditLog-list",{params:s})}auditLogDelete(e){let s={};return s=e,this.http.delete(this.url+"",{params:s})}auditModuleList(e){return this.http.get(this.url+"/auditlog/module-list",{params:e})}auditLogListCount(e){return this.http.get(this.url+"/auditlog/auditLog-list",{params:e})}userlist(e){return this.http.get(this.url+"/auth/userlist",{params:e})}deleteLogs(e){return this.http.post(this.url+"/auditlog/delete-auditlog",e)}static{this.\u0275fac=(()=>{let e;return function(o){return(e||(e=t.xGo(i)))(o||i)}})()}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac})}}return i})(),$t=(()=>{class i{constructor(e,s,o){this.action$=e,this.auditService=s,this.sandbox=o,this.AuditLog$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.AUDIT_LOG_LIST),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.auditLogList(a).pipe((0,m.n)(n=>[new r.TH(n)]),(0,v.W)(n=>(0,y.of)(new r.Mc(n))))))),this.AuditLogDelete$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.AUDIT_LOG_DELETE),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.auditLogDelete(a).pipe((0,m.n)(n=>[new r.YL(n)]),(0,v.W)(n=>(0,y.of)(new r.p0(n))))))),this.AuditLogCount$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.AUDIT_LOG_LIST_COUNT),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.auditLogListCount(a).pipe((0,m.n)(n=>[new r.ym(n)]),(0,v.W)(n=>(0,y.of)(new r.jj(n))))))),this.AuditModule$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.AUDIT_MODULE_LIST),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.auditModuleList(a).pipe((0,m.n)(n=>[new r.Jf(n)]),(0,v.W)(n=>(0,y.of)(new r.c7(n))))))),this.deleteLog$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.DELETE_LOGS),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.deleteLogs(a).pipe((0,m.n)(n=>[new r.kN(n)]),(0,v.W)(n=>(0,y.of)(new r.Bu(n))))))),this.doUserList$=(0,p.EH)(()=>this.action$.pipe((0,p.gp)(r.Q3.GET_USER_LIST),(0,f.T)(a=>a.payload),(0,m.n)(a=>this.auditService.userlist(a).pipe((0,f.T)(n=>new r.Gq(n)),(0,v.W)(n=>(0,y.of)(new r.VY(n)))))))}static{this.\u0275fac=function(s){return new(s||i)(t.KVO(p.En),t.KVO(T),t.KVO(M))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac})}}return i})(),Tt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({providers:[M,T,b.vh],imports:[b.MD,bt,h.YN,h.X1,Mt.G,Ct.h,C.UN,p.Vm.forFeature([$t]),F.h.forChild({loader:{provide:F.Wr,useFactory:St.M,deps:[Dt.Qq]}})]})}}return i})()}}]);