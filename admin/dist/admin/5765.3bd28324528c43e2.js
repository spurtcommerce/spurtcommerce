"use strict";(self.webpackChunkspurtcommerce=self.webpackChunkspurtcommerce||[]).push([[5765],{55765:(rt,x,o)=>{o.r(x),o.d(x,{TaxModule:()=>st});var c=o(60177),r=o(89417),S=o(21626),O=o(74054),F=o(55153),h=o(80493),f=o(15979),u=o(41780),b=o(37886),I=o(99014),d=o(51188);const k={title:{label:"Settings.Local.Tax.TaxName",name:"title",aliasName:"Settings.Local.Tax.TaxName",validatiors:[r.k0.required,r.k0.maxLength(150),r.k0.pattern(/^[a-zA-Z\s]*$/)],type:"text",mandatory:!0,optionalErrorMessage:{pattern:"ValidationsErrorMessage.Allowonlyalphabetsspaces"},placeholder:"Settings.Local.Tax.Title"},value:{label:"Settings.Local.Tax.Value",name:"value",aliasName:"Settings.Local.Tax.Value",validatiors:[r.k0.required,r.k0.maxLength(8)],type:"number",mandatory:!0,placeholder:"Settings.Local.Tax.Number"},status:{label:"Settings.Local.Tax.Status",name:"status",aliasName:"Settings.Local.Tax.Status",mandatory:!0,validatiors:[r.k0.required],type:"ngSelect",placeholder:"placeholder.Choose Role",customData:{data:[{name:"Active",id:"1"},{name:"In-Active",id:"0"}],key:"name",value:"id"}}};var p=o(98852),t=o(54438),v=o(345),T=o(18186);function G(i,l){if(1&i&&(t.qex(0),t.j41(1,"div",9),t.nrm(2,"app-common-form",10),t.k0s(),t.bVm()),2&i){const e=l.$implicit,a=t.XpG();t.R7$(2),t.Y8G("type",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].type)("control",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].control)("label",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].label)("inputId",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].inputId)("aliasName",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].aliasName)("placeholder",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].placeholder)("submitted",a.submitted)("customData",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].customData)("optionalErrorMessage",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].optionalErrorMessage)("mandatory",null==a.dynamicObjControls[e]?null:a.dynamicObjControls[e].mandatory)}}let C=(()=>{class i{constructor(e,a,n,s,m,g,y){this.modalService=e,this.fb=a,this.sandbox=n,this.route=s,this.taxService=m,this.router=g,this.titleService=y,this.params={},this.editedValueTax={},this.submitted=!1,this.rupeeError=[],this._Object=Object,this.dynamicObjControls={},this.titleService.setTitle("Settings | Localization")}ngOnInit(){this.buildForm()}buildForm(){const e=k,a=(0,p.b0)(e);this.formObjFormGroup=this.fb.group(a),Object.keys(e).forEach(n=>{this.dynamicObjControls[n]=(0,p.yE)(e[n],this.formObjFormGroup)}),this.intializeFunction()}onSubmit(){if(this.submitted=!0,!this.formObjFormGroup.valid)return;const e={};e.title=this.formObjFormGroup.value.title,e.code=this.formObjFormGroup.value.code,e.symbolLeft=this.formObjFormGroup.value.symbolLeft,e.symbolRight=this.formObjFormGroup.value.symbolRight,e.value=this.formObjFormGroup.value.value,e.status=this.formObjFormGroup.value.status,this.editedValueTax?(e.taxId=this.editedValueTax.taxId,this.sandbox.updateTax(e),this.updateTaxSubscription=this.sandbox.taxUpdate$.subscribe(a=>{a&&1===a.status&&this.modalService.close("clear")})):(this.sandbox.addtax(e),this.updateTaxSubscription=this.sandbox.taxNew$.subscribe(a=>{1==a?.status&&this.modalService.close("clear")}))}close(){this.modalService.close("close")}cancel(){this.taxService.setEditedValue(""),this.router.navigate(["/settings/local/tax"])}numberOnly(e){if(e.target.value+e.key>100)return!1;const n=e.which?e.which:e.keyCode;return!(n>31&&(n<48||n>57))}intializeFunction(){this.editTaxId=this.route.snapshot.paramMap.get("id"),this.editTaxForm()}editTaxForm(){this.editedValueTax=this.taxService.getEditedValue(),this.editedValueTax&&(this.taxId=this.editedValueTax.taxId,this.formObjFormGroup.controls.title.setValue(this.editedValueTax.title),this.formObjFormGroup.controls.value.setValue(this.editedValueTax.value),this.formObjFormGroup.controls.status.setValue(String(this.editedValueTax.isActive)))}ngOnDestroy(){this.updateTaxSubscription&&this.updateTaxSubscription.unsubscribe()}static{this.\u0275fac=function(a){return new(a||i)(t.rXU(b.Lw),t.rXU(r.ze),t.rXU(h.R),t.rXU(d.nX),t.rXU(f.n),t.rXU(d.Ix),t.rXU(v.hE))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-spurt-taxadd"]],decls:14,vars:8,consts:[[1,"flex","setting2-inner-header"],[1,"modal-header__title"],[1,"close-modal",3,"click"],["src","assets/img/modal-close.svg"],[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"action-button-container","flex"],[1,"button-reg","btn-md","tertiary",3,"click"],["type","button",1,"button-reg","btn-md","primary",3,"click"],[1,"form-group"],[3,"type","control","label","inputId","aliasName","placeholder","submitted","customData","optionalErrorMessage","mandatory"]],template:function(a,n){1&a&&(t.j41(0,"div",0)(1,"h3",1),t.EFF(2),t.k0s(),t.j41(3,"button",2),t.bIt("click",function(){return n.close()}),t.nrm(4,"img",3),t.k0s()(),t.j41(5,"div",4),t.DNE(6,G,3,10,"ng-container",5),t.k0s(),t.j41(7,"div",6)(8,"button",7),t.bIt("click",function(){return n.close()}),t.EFF(9),t.nI1(10,"translate"),t.k0s(),t.j41(11,"button",8),t.bIt("click",function(){return n.onSubmit()}),t.EFF(12),t.nI1(13,"translate"),t.k0s()()),2&a&&(t.R7$(2),t.SpI(" ",n.taxId?"Update Tax":"Add Tax"," "),t.R7$(4),t.Y8G("ngForOf",n._Object.keys(n.dynamicObjControls)),t.R7$(3),t.JRh(t.bMT(10,4,"common.Cancel")),t.R7$(3),t.JRh(t.bMT(13,6,"Settings.Local.Save")))},dependencies:[c.Sq,T.V,u.D9],styles:["sup[_ngcontent-%COMP%], .error[_ngcontent-%COMP%]{color:red}"]})}}return i})();var L=o(55735),V=o(64363);function j(i){for(const l in i)i.hasOwnProperty(l)&&(null==i[l]||""===i[l])&&delete i[l];return i}const M={search:{name:"search",aliasName:"",validatiors:[],type:"text",placeholder:"marketplace.common.Search"}},R={1:{text:"common.Active",class:"active"},0:{text:"common.In-Active",class:"inactive"}};var $=o(18359),_=o(27952),N=o(34501),P=o(42612),A=o(87277),D=o(35697);const X=["myDropdown"],U=["myInput"],w=i=>({productStatus:i});function Y(i,l){if(1&i&&(t.qex(0),t.EFF(1),t.nI1(2,"date"),t.bVm()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,e.value,"dd/MM/YYYY")," ")}}function z(i,l){if(1&i&&(t.qex(0),t.EFF(1),t.bVm()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",1==e.value?"Active":"In-active"," ")}}function B(i,l){if(1&i&&(t.qex(0),t.EFF(1),t.bVm()),2&i){const e=t.XpG(2).$implicit;t.R7$(),t.SpI(" ",e.value," ")}}function Q(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",20)(1,"span"),t.EFF(2),t.k0s(),t.qex(3,21),t.DNE(4,Y,3,4,"ng-container",22)(5,z,2,1,"ng-container",22)(6,B,2,1,"ng-container",23),t.bVm(),t.j41(7,"button",24),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,s=t.XpG();return t.Njj(s.removeFilter(n))}),t.nrm(8,"img",25),t.k0s()()}if(2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI("",e.key," : "),t.R7$(),t.Y8G("ngSwitch",e.key),t.R7$(),t.Y8G("ngSwitchCase","Date"),t.R7$(),t.Y8G("ngSwitchCase","Status")}}function H(i,l){if(1&i&&(t.j41(0,"div",18),t.DNE(1,Q,9,4,"div",19),t.k0s()),2&i){const e=l.$implicit,a=t.XpG();t.R7$(),t.Y8G("ngIf",!a.empty.includes(e.value))}}function J(i,l){1&i&&t.nrm(0,"app-list-skeleton")}function K(i,l){if(1&i){const e=t.RV6();t.j41(0,"app-common-table",26),t.nI1(1,"async"),t.bIt("buttonChangeEvent",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.buttonAction(n))}),t.k0s()}if(2&i){const e=t.XpG(),a=t.sdS(31);t.Y8G("HeadArray",e.dynamicColumnFields)("GridArray",t.bMT(1,3,e.sandbox.taxList$))("customTemplate",t.eq3(5,w,a))}}function Z(i,l){if(1&i&&t.nrm(0,"app-common-badge",27),2&i){const e=l.$implicit,a=t.XpG();t.Y8G("badge",a.badgeStatusMappings.hasOwnProperty(e.isActive)?a.badgeStatusMappings[e.isActive]:"")}}function W(i,l){1&i&&(t.j41(0,"div",28)(1,"span"),t.nrm(2,"img",29),t.k0s(),t.j41(3,"h5"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()),2&i&&(t.R7$(4),t.JRh(t.bMT(5,1,"Dashboard.NoDatafound")))}function q(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",30)(1,"app-reusable-pagination",31),t.bIt("pageChange",function(n){t.eBV(e);const s=t.XpG();return t.Njj(s.onPageChange(n))}),t.k0s()()}if(2&i){const e=t.XpG();t.R7$(),t.Y8G("type","numbers")("currentPage",e.currentPage)("totalItems",e.taxCount)("pageSize",e.limit)}}const at=[{path:"",component:(()=>{class i{constructor(e,a,n,s,m,g,y,lt){this.modal=e,this.sandbox=a,this.taxService=n,this.router=s,this.titleService=m,this.fb=g,this.route=y,this.ref=lt,this.dynamicColumnFields=structuredClone((()=>{const i=(0,V.ZQ)();return[{displayName:"Settings.Local.Tax.TaxName",id:"title",type:"default",checked:!0,filterColName:"uniformListColumName.orderId"},{displayName:"Settings.Local.Tax.Value",id:"value",type:"default",checked:!0,filterColName:"uniformListColumName.customerName"},{displayName:"Settings.Local.Tax.Status",id:"productStatus",type:"template",checked:!0,filterColName:"Settings.Local.Tax.Status",customStyle:{trow:{class:"text-center"},tbody:{class:"text-center"}}},{displayName:"Settings.Local.Country.Action",type:"threeDotMenu",checked:!0,isDisable:!i["edit-tax"]&&!i["delete-tax"],customStyle:{trow:{class:"text-center"},tbody:{class:"text-center"}},menuData:[{name:"Edit",img:"assets/img/edit.svg",displayName:"marketplace.common.Edit",isDisable:!i["edit-tax"]},{name:"Delete",img:"assets/img/delete-new.svg",displayName:"marketplace.common.Delete",isDisable:!i["delete-tax"]}]}]})()),this.badgeStatusMappings=R,this.type="edit",this.filterSearch={},this.limit=sessionStorage.getItem("itemsPerPage")?Number(sessionStorage.getItem("itemsPerPage")):10,this.offset=0,this.currentPage=1,this.keyword="",this.dynamicObjControls={},this.backupFormValue={},this.formValueExists=!1,this._Object=Object,this.empty=[null,"",void 0],this.subscriptions=new $.yU,this.titleService.setTitle("Settings | Localization")}ngOnInit(){this.buildForm(),this.routeSubscribe()}buttonAction(e){"threeDotMenu"===e.key&&("Delete"==e.actionType?this.deleteTax(e?.taxId):"Edit"==e.actionType&&this.editTax(e))}addTax(e,a){const n=this.modal.open(C,{windowClass:"add-local",keyboard:!1,backdrop:"static",animation:!1});this.taxService.setEditedValue(""),n.result.then(s=>{"clear"==s&&this.routeSubscribe()})}editTax(e){const a=this.modal.open(C,{windowClass:"add-local",keyboard:!1,backdrop:"static",animation:!1});this.taxService.setEditedValue(e),a.componentInstance.edit=this.type,a.componentInstance.id=e.countryId,a.result.then(n=>{"clear"==n&&this.routeSubscribe()})}deleteTax(e){const a=this.modal.open(L.i,{size:"sm",windowClass:"delete-confirm",backdrop:"static",modalDialogClass:"modal-dialog-centered",backdropClass:"createcr"});a.componentInstance.key="",a.componentInstance.id="",a.componentInstance.deleteMessage="Tax",a.result.then(n=>{"deleted"===n&&(this.sandbox.deleteTax({taxId:e}),this.regSubscribeEvents())})}removeFilter(e){this.formObjFormGroup.controls[e.key].reset(),this.filterValueUpdate(),this.resetAll()}onPageChange(e){this.limit=e.limit,this.currentPage=Math.floor(e.offset/e.limit)+1,this.taxList()}applyFilter(){this.filterValueUpdate(),this.resetAll()}regSubscribeEvents(){this.sandbox.getTaxDelete$.subscribe(e=>{e&&1===e.status&&(this.taxList(this.pageoffset),this.countPaginationApi())})}taxList(e=0){this.offset=(this.currentPage-1)*this.limit;const a=j(this.getQueryParam());a.count=0,this.sandbox.getTaxList(a),this.updateQueryParam()}countPaginationApi(){this.offset=(this.currentPage-1)*this.limit;const e=j(this.getQueryParam());e.count=1,this.sandbox.getTaxListCount(e),this.sandbox.taxListCount$.subscribe(a=>{a&&(this.taxCount=a.data,this.ref.markForCheck())})}updateQueryParam(){this.router.navigate([],{queryParams:this.getQueryParam(),queryParamsHandling:"merge"})}getQueryParam(){return{limit:this.limit,offset:this.offset,keyword:this.backupFormValue.search??""}}resetAll(){this.onPageChange({limit:this.limit,offset:0}),this.countPaginationApi(),this.dropDownClose("myDropdown")}buildForm(){const e=M,a=(0,p.gQ)(e);this.formObjFormGroup=this.fb.group(a),Object.keys(e).forEach(n=>{this.dynamicObjControls[n]=(0,p.yE)(e[n],this.formObjFormGroup)}),this.filterValueUpdate()}dropDownClose(e){this.hasOwnProperty(e)&&this[e]?.close()}filterValueUpdate(){this.backupFormValue=structuredClone(this.formObjFormGroup?.value),this.formValueExists=Object.values(this.backupFormValue).some(e=>!this.empty.includes(e))}routeSubscribe(){let e={};this.subscriptions.add(this.route.queryParams.subscribe(a=>{e=a,this.limit=e.limit?Number(e.limit):this.limit,this.offset=e.offset?Number(e.offset):0,this.currentPage=e.offset&&e.limit?Math.floor(e.offset/e.limit)+1:1,this.formObjFormGroup.patchValue({search:e.keyword??""}),this.filterValueUpdate()})),this.taxList(),this.countPaginationApi()}static{this.\u0275fac=function(a){return new(a||i)(t.rXU(b.Bq),t.rXU(h.R),t.rXU(f.n),t.rXU(d.Ix),t.rXU(v.hE),t.rXU(r.ze),t.rXU(d.nX),t.rXU(t.gRc))}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-spurt-taxlist"]],viewQuery:function(a,n){if(1&a&&(t.GBs(X,5),t.GBs(U,5)),2&a){let s;t.mGM(s=t.lsd())&&(n.myDropdown=s.first),t.mGM(s=t.lsd())&&(n.myInput=s.first)}},decls:36,vars:35,consts:[["itemTemplateRef",""],[1,"local-content"],[1,"set-lay-notes","flex"],[1,"flex","filter-row"],[1,"filter-lft"],[1,"filter-rht","flex"],["class","added-filter flex",4,"ngFor","ngForOf"],[1,"filter-search"],[1,"",3,"keyup.enter"],[3,"type","control","inputId","placeholder"],["appShowHide","",1,"button-reg","primary","btn-sm",3,"click","hideUnAuthorized"],[1,"flex","product-wrap","example-full-width"],[1,"product-table"],[4,"ngIf"],[1,""],[3,"HeadArray","GridArray","customTemplate","buttonChangeEvent",4,"ngIf"],["class","nodata-found",4,"ngIf"],["class","pagination flex",4,"ngIf"],[1,"added-filter","flex"],["class","added-filter-col flex",4,"ngIf"],[1,"added-filter-col","flex"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"click"],["src","assets/img/close.svg","alt",""],[3,"buttonChangeEvent","HeadArray","GridArray","customTemplate"],[3,"badge"],[1,"nodata-found"],["src","assets/imgs/nodatafound.svg","alt",""],[1,"pagination","flex"],[3,"pageChange","type","currentPage","totalItems","pageSize"]],template:function(a,n){if(1&a){const s=t.RV6();t.j41(0,"div",1)(1,"div",2)(2,"h4"),t.EFF(3),t.nI1(4,"translate"),t.k0s(),t.j41(5,"p"),t.EFF(6),t.nI1(7,"translate"),t.k0s()(),t.j41(8,"div",3)(9,"div",4)(10,"h2"),t.EFF(11),t.nI1(12,"translate"),t.k0s()(),t.j41(13,"div",5),t.DNE(14,H,2,1,"div",6),t.nI1(15,"keyvalue"),t.j41(16,"div",7)(17,"form",8),t.bIt("keyup.enter",function(){return t.eBV(s),t.Njj(n.applyFilter())}),t.nrm(18,"app-common-form",9),t.k0s()(),t.j41(19,"button",10),t.bIt("click",function(){return t.eBV(s),t.Njj(n.addTax("","add"))}),t.EFF(20),t.nI1(21,"translate"),t.k0s()()(),t.j41(22,"div",11)(23,"div",12),t.DNE(24,J,1,0,"app-list-skeleton",13),t.nI1(25,"async"),t.j41(26,"div",14),t.DNE(27,K,2,7,"app-common-table",15),t.nI1(28,"async"),t.nI1(29,"async"),t.DNE(30,Z,1,1,"ng-template",null,0,t.C5r)(32,W,6,3,"div",16),t.nI1(33,"async"),t.nI1(34,"async"),t.DNE(35,q,2,4,"div",17),t.k0s()()()()}if(2&a){let s,m;t.R7$(3),t.JRh(t.bMT(4,15,"Settings.nav.Note:")),t.R7$(3),t.SpI("",t.bMT(7,17,"Settings.paragraph.admincanaddvarioustaxes")," "),t.R7$(5),t.Lme(" ",t.bMT(12,19,"Settings.Common.TotalTax")," ( ",n.taxCount," )"),t.R7$(3),t.Y8G("ngForOf",t.bMT(15,21,n.backupFormValue)),t.R7$(4),t.Y8G("type",null==n.dynamicObjControls||null==n.dynamicObjControls.search?null:n.dynamicObjControls.search.type)("control",null==n.dynamicObjControls||null==n.dynamicObjControls.search?null:n.dynamicObjControls.search.control)("inputId",null==n.dynamicObjControls||null==n.dynamicObjControls.search?null:n.dynamicObjControls.search.inputId)("placeholder",null==n.dynamicObjControls||null==n.dynamicObjControls.search?null:n.dynamicObjControls.search.placeholder),t.R7$(),t.Y8G("hideUnAuthorized","create-tax"),t.R7$(),t.SpI(" + ",t.bMT(21,23,"Settings.Local.Tax.AddTax")," "),t.R7$(4),t.Y8G("ngIf",t.bMT(25,25,n.sandbox.taxListLoading$)),t.R7$(3),t.Y8G("ngIf",(null==(s=t.bMT(28,27,n.sandbox.taxList$))?null:s.length)>0&&!t.bMT(29,29,n.sandbox.taxListLoading$)),t.R7$(5),t.Y8G("ngIf",t.bMT(34,33,0===(null==(m=t.bMT(33,31,n.sandbox.taxList$))?null:m.length)&&n.sandbox.taxListLoaded$)),t.R7$(3),t.Y8G("ngIf",n.taxCount>n.limit)}},dependencies:[c.Sq,c.bT,c.ux,c.e1,c.fG,r.qT,r.cb,r.cV,_.s,N.$,P.V,T.V,A.C,D.D,c.Jj,c.vh,c.lG,u.D9],styles:[".settings-right-wrapper[_ngcontent-%COMP%]{margin-top:0!important}.coc[_ngcontent-%COMP%]{background:#f20a6d;border:solid thin #dddddd;color:#fff;padding:4px 16px}.filterKeyword[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:none!important}.filterKeyword[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0}"]})}}return i})(),canActivate:[o(79176).q],data:{permission:"list-tax"}}];let it=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({imports:[d.iI.forChild(at),d.iI]})}}return i})();var nt=o(88650),ot=o(48256);let st=(()=>{class i{static{this.\u0275fac=function(a){return new(a||i)}}static{this.\u0275mod=t.$C({type:i})}static{this.\u0275inj=t.G2t({providers:[h.R,f.n],imports:[it,O.Vm,ot._B,c.MD,r.YN,r.X1,F.G,nt.h,u.h.forChild({loader:{provide:u.Wr,useFactory:I.M,deps:[S.Qq]}}),b.UN]})}}return i})()}}]);